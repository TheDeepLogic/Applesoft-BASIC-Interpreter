0 REM BLACKJACK WITH SIMPLE GRAPHICS
1 REM STARTING CHIPS=100, TITLE, CELEBRATIONS EACH 100 CHIP STEP
2 REM USES HGR (MIXED) FOR TITLE/CELEBRATION AND TEXT FOR PROMPTS
10 TEXT:HOME:PRINT "APPLE II BLACKJACK":PRINT "(C) 2025 MICROAPPLE SOFT":PRINT ""
20 PRINT "LOADING...":RANDOMIZE:REM SHUFFLE SEED
30 DIM D(52),P1(10),P2(10),DH(10)
40 CH=100:TARGET=200:REM NEXT CELEBRATION AT 200
50 GOSUB 9000:REM TITLE SCREEN
60 GOSUB 8000:REM INIT DECK
70 GOSUB 2000:REM MAIN LOOP
80 END

2000 REM MAIN GAME LOOP
2010 IF DI>40 THEN GOSUB 8000
2020 HOME:PRINT "CHIPS:";CH
2030 INPUT "BET (1-";CH;"):";B
2040 IF B<1 OR B>CH THEN PRINT "INVALID BET":GOTO 2030
2050 REM DEAL INITIAL
2060 N1=0:N2=0:ND=0:SPLIT=0:B2=0:DOUBLE1=0:DOUBLE2=0
2070 GOSUB 8200:GOSUB 8200:REM PLAYER 2 CARDS
2080 GOSUB 8300:GOSUB 8300:REM DEALER 2 CARDS (SECOND FACE DOWN)
2090 IF P1(1)=P1(2) AND CH>=B*2 THEN PRINT "YOU CAN SPLIT (Y/N)?";:GET A$:IF A$="Y" OR A$="y" THEN GOSUB 5000
2100 REM PLAY PRIMARY HAND
2110 GOSUB 4000
2120 IF SPLIT=1 THEN GOSUB 4100 ELSE GOSUB 4200
2130 REM DEALER PLAYS IF AT LEAST ONE HAND NOT BUST
2140 IF (SPLIT=0 AND P1T<=21) OR (SPLIT=1 AND (P1T<=21 OR P2T<=21)) THEN GOSUB 4400
2150 REM RESOLVE OUTCOMES
2160 IF SPLIT=0 THEN GOSUB 4600 ELSE GOSUB 4700
2170 IF CH<=0 THEN PRINT "OUT OF CHIPS! GAME OVER":END
2180 IF CH>=TARGET THEN GOSUB 9100:TARGET=TARGET+100
2190 PRINT "PLAY AGAIN (Y/N)?";:GET A$:IF A$="Y" OR A$="y" THEN GOTO 2010
2200 END

4000 REM SHOW HANDS AND STATUS
4010 HOME:PRINT "BET:";B:IF SPLIT=1 THEN PRINT "BET2:";B2
4020 PRINT "DEALER: ";:FOR I=1 TO ND:IF I=1 AND DEALER_HIDE=1 THEN PRINT "[HIDDEN]";:GOTO 4050
4030 GOSUB 6000:PRINT " ";
4050 NEXT I:PRINT
4060 PRINT "PLAYER HAND";:IF SPLIT=1 THEN PRINT " (HAND A)" ELSE PRINT
4070 FOR I=1 TO N1:GOSUB 6100:PRINT " ";:NEXT I:PRINT "TOTAL:";P1T
4080 IF SPLIT=1 THEN PRINT "PLAYER HAND (HAND B)":FOR I=1 TO N2:GOSUB 6200:PRINT " ";:NEXT I:PRINT "TOTAL:";P2T
4090 RETURN

4100 REM SPLIT HAND PLAY SEQUENTIAL
4110 HAND=1:GOSUB 4200
4120 HAND=2:GOSUB 4200
4130 RETURN

4200 REM PLAY SINGLE HAND (HAND=1 DEFAULT)
4210 IF HAND=0 THEN HAND=1
4220 IF HAND=1 THEN T=P1T ELSE T=P2T
4230 DOUBLEOK=0:IF (HAND=1 AND N1=2) OR (HAND=2 AND N2=2) THEN DOUBLEOK=1
4240 IF T=21 AND ((HAND=1 AND N1=2) OR (HAND=2 AND N2=2)) THEN PRINT "BLACKJACK!":RETURN
4250 PRINT "(H)IT (S)TAND";:IF DOUBLEOK THEN PRINT " (D)OUBLE";
4260 PRINT :INPUT "CHOICE? ";A$
4270 IF A$="H" OR A$="h" THEN GOSUB 4300:GOTO 4200
4280 IF A$="S" OR A$="s" THEN RETURN
4290 IF DOUBLEOK AND (A$="D" OR A$="d") THEN IF HAND=1 THEN DOUBLE1=1:B=B*2 ELSE DOUBLE2=1:B2=B2*2:GOSUB 4300:RETURN
4295 PRINT "INVALID":GOTO 4250

4300 REM HIT CURRENT HAND
4310 IF HAND=1 THEN GOSUB 8200 ELSE GOSUB 8250
4320 GOSUB 4000
4330 IF HAND=1 THEN IF P1T>21 THEN PRINT "BUST!":RETURN
4340 IF HAND=2 THEN IF P2T>21 THEN PRINT "BUST!":RETURN
4350 RETURN

4400 REM DEALER PLAY
4410 DEALER_HIDE=0:GOSUB 4000
4420 IF DT>=17 THEN RETURN
4430 GOSUB 8300:GOSUB 4000:GOTO 4420

4600 REM RESOLVE SINGLE HAND
4610 REM CHECK BLACKJACK PAYOUT
4620 BJ=0:IF N1=2 AND P1T=21 THEN BJ=1
4630 IF P1T>21 THEN PRINT "YOU BUST":CH=CH-B:RETURN
4640 IF DT>21 THEN PRINT "DEALER BUSTS":CH=CH+B*(1.5*BJ+1):RETURN
4650 IF BJ=1 AND DT<>21 THEN PRINT "BLACKJACK!" :CH=CH+B*1.5+B:RETURN
4660 IF P1T>DT THEN PRINT "YOU WIN":CH=CH+B:RETURN
4670 IF P1T<DT THEN PRINT "YOU LOSE":CH=CH-B:RETURN
4680 PRINT "PUSH":RETURN

4700 REM RESOLVE SPLIT HANDS
4710 REM HAND A
4720 FOR H=1 TO 2
4730 IF H=1 THEN T=P1T:BET=B ELSE T=P2T:BET=B2
4740 IF T>21 THEN PRINT "HAND";CHR$(64+H);" BUSTS":CH=CH-BET:GOTO 4790
4750 IF DT>21 THEN PRINT "DEALER BUSTS - HAND";CHR$(64+H);" WINS":CH=CH+BET:IF H=2 AND DT>21 THEN 4790 ELSE 4790
4760 IF T>DT THEN PRINT "HAND";CHR$(64+H);" WINS":CH=CH+BET:GOTO 4790
4770 IF T<DT THEN PRINT "HAND";CHR$(64+H);" LOSES":CH=CH-BET:GOTO 4790
4780 PRINT "HAND";CHR$(64+H);" PUSH"
4790 NEXT H
4800 RETURN

5000 REM SPLIT LOGIC
5010 SPLIT=1:B2=B:CH=CH-B:REM PLACE SECOND BET
5020 N2=1:P2(1)=P1(2):N1=1
5030 GOSUB 8200:REM DRAW NEW CARD FOR HAND A
5040 GOSUB 8250:REM DRAW CARD FOR HAND B
5050 RETURN

6000 REM SHOW DEALER CARD I
6010 C=DH(I):GOSUB 6500:RETURN

6100 REM SHOW PLAYER CARD I HAND1
6110 C=P1(I):GOSUB 6500:RETURN

6200 REM SHOW PLAYER CARD I HAND2
6210 C=P2(I):GOSUB 6500:RETURN

6500 REM PRINT CARD FACE
6510 R=((C-1) MOD 13)+1:S=((C-1)\13)
6520 IF R=1 THEN R$="A" ELSE IF R=11 THEN R$="J" ELSE IF R=12 THEN R$="Q" ELSE IF R=13 THEN R$="K" ELSE R$=STR$(R)
6530 IF S=0 THEN S$="H" ELSE IF S=1 THEN S$="D" ELSE IF S=2 THEN S$="C" ELSE S$="S"
6540 PRINT R$+S$;:RETURN

7000 REM HAND TOTALS
7010 RETURN

8000 REM INIT/SHUFFLE DECK
8010 FOR I=1 TO 52:D(I)=I:NEXT I
8020 FOR I=52 TO 2 STEP -1
8030 J=INT(RND(1)*I)+1
8040 T=D(I):D(I)=D(J):D(J)=T
8050 NEXT I
8060 DI=0:RETURN

8100 REM DRAW CARD GENERAL
8110 DI=DI+1:IF DI>52 THEN DI=52
8120 C=D(DI):RETURN

8200 REM DRAW TO PLAYER HAND1
8210 GOSUB 8100:N1=N1+1:P1(N1)=C:GOSUB 8400:P1T=TV
8220 RETURN

8250 REM DRAW TO PLAYER HAND2
8260 GOSUB 8100:N2=N2+1:P2(N2)=C:GOSUB 8450:P2T=TV
8270 RETURN

8300 REM DRAW TO DEALER
8310 GOSUB 8100:ND=ND+1:DH(ND)=C:GOSUB 8500:DT=TV
8320 IF ND=1 THEN DEALER_HIDE=1
8330 RETURN

8400 REM TOTAL FOR HAND1
8410 TV=0:AC=0:FOR X=1 TO N1:GOSUB 8600:NEXT X:RETURN

8450 REM TOTAL FOR HAND2
8460 TV=0:AC=0:FOR X=1 TO N2:GOSUB 8650:NEXT X:RETURN

8500 REM TOTAL FOR DEALER
8510 TV=0:AC=0:FOR X=1 TO ND:GOSUB 8700:NEXT X:RETURN

8600 REM ADD CARD VALUE FROM P1(X)
8610 C=P1(X):GOSUB 8800:RETURN

8650 REM ADD CARD VALUE FROM P2(X)
8660 C=P2(X):GOSUB 8800:RETURN

8700 REM ADD CARD VALUE FROM DH(X)
8710 C=DH(X):GOSUB 8800:RETURN

8800 REM CARD VALUE LOGIC USING C
8810 R=((C-1) MOD 13)+1
8820 V=R:IF R>10 THEN V=10
8830 IF R=1 THEN V=11:AC=AC+1
8840 TV=TV+V
8850 IF TV>21 AND AC>0 THEN TV=TV-10:AC=AC-1
8860 RETURN

9000 REM TITLE SCREEN
9010 HGR:HGR2:HCOLOR=3:FOR Y=0 TO 39 STEP 4:HPLOT 0,Y TO 279,191-Y:NEXT Y
9020 HCOLOR=6:FOR I=0 TO 2:HPLOT 20+I,20 TO 260-I,172:HPLOT 20+I,172 TO 260-I,20:NEXT I
9030 HCOLOR=1:FOR I=0 TO 200 STEP 4:HPLOT 40,I TO 240,191-I:NEXT I
9040 HTAB 8:VTAB 10:PRINT "APPLE II BLACKJACK"
9050 HTAB 6:VTAB 12:PRINT "BET. HIT. STAND. SPLIT. WIN."
9060 HTAB 5:VTAB 14:PRINT "PRESS ANY KEY TO START"
9070 GET A$:IF A$="" THEN 9070
9080 HGR:TEXT:HOME:RETURN

9100 REM CELEBRATION SCREEN WHEN HITTING NEW 100 MARK
9110 HGR:HGR2:HCOLOR=5:FOR I=0 TO 500:HPLOT RND(1)*279,RND(1)*191:NEXT I
9120 HCOLOR=2:FOR I=0 TO 15:HPLOT 140,96 TO RND(1)*279,RND(1)*191:NEXT I
9130 HTAB 7:VTAB 10:PRINT "NICE RUN! CHIPS=";CH
9140 HTAB 5:VTAB 12:PRINT "PRESS RETURN TO CONTINUE"
9150 INPUT "";A$
9160 HGR:TEXT:RETURN
